/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/chess.js@1.4.0/src/pgn.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
function rootNode(t){return null!==t?{comment:t,variations:[]}:{variations:[]}}function node(t,r,e,n,o){const a={move:t,variations:o};return r&&(a.suffix=r),e&&(a.nag=e),null!==n&&(a.comment=n),a}function lineToTree(...t){const[r,...e]=t;let n=r;for(const t of e)null!==t&&(n.variations=[t,...t.variations],t.variations=[],n=t);return r}function pgn(t,r){if(r.marker&&r.marker.comment){let t=r.root;for(;;){const e=t.variations[0];if(!e){t.comment=r.marker.comment;break}t=e}}return{headers:t,root:r.root,result:(r.marker&&r.marker.result)??void 0}}function peg$subclass(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}function peg$SyntaxError(t,r,e,n){var o=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(o,peg$SyntaxError.prototype),o.expected=r,o.found=e,o.location=n,o.name="SyntaxError",o}function peg$padEnd(t,r,e){return e=e||" ",t.length>r?t:(r-=t.length,t+(e+=e.repeat(r)).slice(0,r))}function peg$parse(t,r){var e,n={},o=(r=void 0!==r?r:{}).grammarSource,a={pgn:Bt},u=Bt,c="[",i='"',s="]",l=".",f="O-O-O",p="O-O",g="0-0-0",h="0-0",m="$",d="{",A="}",v=";",x="(",y=")",$="1-0",b="0-1",E="1/2-1/2",C="*",S=/^[a-zA-Z]/,O=/^[^"]/,F=/^[0-9]/,k=/^[.]/,w=/^[a-zA-Z1-8\-=]/,R=/^[+#]/,j=/^[!?]/,P=/^[^}]/,z=/^[^\r\n]/,T=/^[ \t\r\n]/,Z=Gt("tag pair"),N=Mt("[",!1),M=Mt('"',!1),D=Mt("]",!1),G=Gt("tag name"),I=Dt([["a","z"],["A","Z"]],!1,!1),L=Gt("tag value"),U=Dt(['"'],!0,!1),q=Gt("move number"),B=Dt([["0","9"]],!1,!1),H=Mt(".",!1),J=Dt(["."],!1,!1),K=Gt("standard algebraic notation"),Q=Mt("O-O-O",!1),V=Mt("O-O",!1),W=Mt("0-0-0",!1),X=Mt("0-0",!1),Y=Dt([["a","z"],["A","Z"],["1","8"],"-","="],!1,!1),_=Dt(["+","#"],!1,!1),tt=Gt("suffix annotation"),rt=Dt(["!","?"],!1,!1),et=Gt("NAG"),nt=Mt("$",!1),ot=Gt("brace comment"),at=Mt("{",!1),ut=Dt(["}"],!0,!1),ct=Mt("}",!1),it=Gt("rest of line comment"),st=Mt(";",!1),lt=Dt(["\r","\n"],!0,!1),ft=Gt("variation"),pt=Mt("(",!1),gt=Mt(")",!1),ht=Gt("game termination marker"),mt=Mt("1-0",!1),dt=Mt("0-1",!1),At=Mt("1/2-1/2",!1),vt=Mt("*",!1),xt=Gt("whitespace"),yt=Dt([" ","\t","\r","\n"],!1,!1),$t=function(t,r){return pgn(t,r)},bt=function(t){return Object.fromEntries(t)},Et=function(t,r){return[t,r]},Ct=function(t,r){return{root:t,marker:r}},St=function(t,r){return lineToTree(rootNode(t),...r.flat())},Ot=function(t,r,e,n,o){return node(t,r,e,n,o)},Ft=function(t){return t},kt=function(t){return t.replace(/[\r\n]+/g," ")},wt=function(t){return t.trim()},Rt=function(t){return t},jt=function(t,r){return{result:t,comment:r}},Pt=0|r.peg$currPos,zt=[{line:1,column:1}],Tt=Pt,Zt=r.peg$maxFailExpected||[],Nt=0|r.peg$silentFails;if(r.startRule){if(!(r.startRule in a))throw new Error("Can't start parsing from rule \""+r.startRule+'".');u=a[r.startRule]}function Mt(t,r){return{type:"literal",text:t,ignoreCase:r}}function Dt(t,r,e){return{type:"class",parts:t,inverted:r,ignoreCase:e}}function Gt(t){return{type:"other",description:t}}function It(r){var e,n=zt[r];if(n)return n;if(r>=zt.length)e=zt.length-1;else for(e=r;!zt[--e];);for(n={line:(n=zt[e]).line,column:n.column};e<r;)10===t.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return zt[r]=n,n}function Lt(t,r,e){var n=It(t),a=It(r),u={source:o,start:{offset:t,line:n.line,column:n.column},end:{offset:r,line:a.line,column:a.column}};return e&&o&&"function"==typeof o.offset&&(u.start=o.offset(u.start),u.end=o.offset(u.end)),u}function Ut(t){Pt<Tt||(Pt>Tt&&(Tt=Pt,Zt=[]),Zt.push(t))}function qt(t,r,e){return new peg$SyntaxError(peg$SyntaxError.buildMessage(t,r),t,r,e)}function Bt(){var r,e,o;return r=Pt,e=function(){var t,r,e;t=Pt,r=[],e=Ht();for(;e!==n;)r.push(e),e=Ht();return e=Xt(),t=bt(r),t}(),o=function(){var r,e,o;r=Pt,e=Jt(),Xt(),o=function(){var r,e,o;Nt++,r=Pt,t.substr(Pt,3)===$?(e=$,Pt+=3):(e=n,0===Nt&&Ut(mt));e===n&&(t.substr(Pt,3)===b?(e=b,Pt+=3):(e=n,0===Nt&&Ut(dt)),e===n&&(t.substr(Pt,7)===E?(e=E,Pt+=7):(e=n,0===Nt&&Ut(At)),e===n&&(42===t.charCodeAt(Pt)?(e=C,Pt++):(e=n,0===Nt&&Ut(vt)))));e!==n?(Xt(),(o=Vt())===n&&(o=null),r=jt(e,o)):(Pt=r,r=n);Nt--,r===n&&(e=n,0===Nt&&Ut(ht));return r}(),o===n&&(o=null);return Xt(),r=Ct(e,o),r}(),r=$t(e,o)}function Ht(){var r,e,o,a,u,l,f;return Nt++,r=Pt,Xt(),91===t.charCodeAt(Pt)?(e=c,Pt++):(e=n,0===Nt&&Ut(N)),e!==n?(Xt(),o=function(){var r,e,o;Nt++,r=Pt,e=[],o=t.charAt(Pt),S.test(o)?Pt++:(o=n,0===Nt&&Ut(I));if(o!==n)for(;o!==n;)e.push(o),o=t.charAt(Pt),S.test(o)?Pt++:(o=n,0===Nt&&Ut(I));else e=n;r=e!==n?t.substring(r,Pt):e;Nt--,r===n&&(e=n,0===Nt&&Ut(G));return r}(),o!==n?(Xt(),34===t.charCodeAt(Pt)?(a=i,Pt++):(a=n,0===Nt&&Ut(M)),a!==n?(u=function(){var r,e,o;Nt++,r=Pt,e=[],o=t.charAt(Pt),O.test(o)?Pt++:(o=n,0===Nt&&Ut(U));for(;o!==n;)e.push(o),o=t.charAt(Pt),O.test(o)?Pt++:(o=n,0===Nt&&Ut(U));r=t.substring(r,Pt),Nt--,e=n,0===Nt&&Ut(L);return r}(),34===t.charCodeAt(Pt)?(l=i,Pt++):(l=n,0===Nt&&Ut(M)),l!==n?(Xt(),93===t.charCodeAt(Pt)?(f=s,Pt++):(f=n,0===Nt&&Ut(D)),f!==n?r=Et(o,u):(Pt=r,r=n)):(Pt=r,r=n)):(Pt=r,r=n)):(Pt=r,r=n)):(Pt=r,r=n),Nt--,r===n&&(0===Nt&&Ut(Z)),r}function Jt(){var t,r,e,o;for(t=Pt,(r=Vt())===n&&(r=null),e=[],o=Kt();o!==n;)e.push(o),o=Kt();return t=St(r,e)}function Kt(){var r,e,o,a,u,c,i,s,m;if(r=Pt,Xt(),e=function(){var r,e,o,a,u,c;Nt++,r=Pt,e=[],o=t.charAt(Pt),F.test(o)?Pt++:(o=n,0===Nt&&Ut(B));for(;o!==n;)e.push(o),o=t.charAt(Pt),F.test(o)?Pt++:(o=n,0===Nt&&Ut(B));46===t.charCodeAt(Pt)?(o=l,Pt++):(o=n,0===Nt&&Ut(H));if(o!==n){for(a=Xt(),u=[],c=t.charAt(Pt),k.test(c)?Pt++:(c=n,0===Nt&&Ut(J));c!==n;)u.push(c),c=t.charAt(Pt),k.test(c)?Pt++:(c=n,0===Nt&&Ut(J));r=e=[e,o,a,u]}else Pt=r,r=n;Nt--,r===n&&(e=n,0===Nt&&Ut(q));return r}(),e===n&&(e=null),Xt(),o=function(){var r,e,o,a,u,c;Nt++,r=Pt,e=Pt,t.substr(Pt,5)===f?(o=f,Pt+=5):(o=n,0===Nt&&Ut(Q));if(o===n&&(t.substr(Pt,3)===p?(o=p,Pt+=3):(o=n,0===Nt&&Ut(V)),o===n&&(t.substr(Pt,5)===g?(o=g,Pt+=5):(o=n,0===Nt&&Ut(W)),o===n&&(t.substr(Pt,3)===h?(o=h,Pt+=3):(o=n,0===Nt&&Ut(X)),o===n))))if(o=Pt,a=t.charAt(Pt),S.test(a)?Pt++:(a=n,0===Nt&&Ut(I)),a!==n){if(u=[],c=t.charAt(Pt),w.test(c)?Pt++:(c=n,0===Nt&&Ut(Y)),c!==n)for(;c!==n;)u.push(c),c=t.charAt(Pt),w.test(c)?Pt++:(c=n,0===Nt&&Ut(Y));else u=n;u!==n?o=a=[a,u]:(Pt=o,o=n)}else Pt=o,o=n;o!==n?(a=t.charAt(Pt),R.test(a)?Pt++:(a=n,0===Nt&&Ut(_)),a===n&&(a=null),e=o=[o,a]):(Pt=e,e=n);r=e!==n?t.substring(r,Pt):e;Nt--,r===n&&(e=n,0===Nt&&Ut(K));return r}(),o!==n){for(a=function(){var r,e,o;Nt++,r=Pt,e=[],o=t.charAt(Pt),j.test(o)?Pt++:(o=n,0===Nt&&Ut(rt));for(;o!==n;)e.push(o),e.length>=2?o=n:(o=t.charAt(Pt),j.test(o)?Pt++:(o=n,0===Nt&&Ut(rt)));e.length<1?(Pt=r,r=n):r=e;Nt--,r===n&&(e=n,0===Nt&&Ut(tt));return r}(),a===n&&(a=null),u=[],c=Qt();c!==n;)u.push(c),c=Qt();for(c=Xt(),(i=Vt())===n&&(i=null),s=[],m=Wt();m!==n;)s.push(m),m=Wt();r=Ot(o,a,u,i,s)}else Pt=r,r=n;return r}function Qt(){var r,e,o,a,u;if(Nt++,r=Pt,Xt(),36===t.charCodeAt(Pt)?(e=m,Pt++):(e=n,0===Nt&&Ut(nt)),e!==n){if(o=Pt,a=[],u=t.charAt(Pt),F.test(u)?Pt++:(u=n,0===Nt&&Ut(B)),u!==n)for(;u!==n;)a.push(u),u=t.charAt(Pt),F.test(u)?Pt++:(u=n,0===Nt&&Ut(B));else a=n;(o=a!==n?t.substring(o,Pt):a)!==n?r=Ft(o):(Pt=r,r=n)}else Pt=r,r=n;return Nt--,r===n&&(0===Nt&&Ut(et)),r}function Vt(){var r;return(r=function(){var r,e,o,a,u;Nt++,r=Pt,123===t.charCodeAt(Pt)?(e=d,Pt++):(e=n,0===Nt&&Ut(at));if(e!==n){for(o=Pt,a=[],u=t.charAt(Pt),P.test(u)?Pt++:(u=n,0===Nt&&Ut(ut));u!==n;)a.push(u),u=t.charAt(Pt),P.test(u)?Pt++:(u=n,0===Nt&&Ut(ut));o=t.substring(o,Pt),125===t.charCodeAt(Pt)?(a=A,Pt++):(a=n,0===Nt&&Ut(ct)),a!==n?r=kt(o):(Pt=r,r=n)}else Pt=r,r=n;Nt--,r===n&&(e=n,0===Nt&&Ut(ot));return r}())===n&&(r=function(){var r,e,o,a,u;Nt++,r=Pt,59===t.charCodeAt(Pt)?(e=v,Pt++):(e=n,0===Nt&&Ut(st));if(e!==n){for(o=Pt,a=[],u=t.charAt(Pt),z.test(u)?Pt++:(u=n,0===Nt&&Ut(lt));u!==n;)a.push(u),u=t.charAt(Pt),z.test(u)?Pt++:(u=n,0===Nt&&Ut(lt));o=t.substring(o,Pt),r=wt(o)}else Pt=r,r=n;Nt--,r===n&&(e=n,0===Nt&&Ut(it));return r}()),r}function Wt(){var r,e,o,a;return Nt++,r=Pt,Xt(),40===t.charCodeAt(Pt)?(e=x,Pt++):(e=n,0===Nt&&Ut(pt)),e!==n&&(o=Jt())!==n?(Xt(),41===t.charCodeAt(Pt)?(a=y,Pt++):(a=n,0===Nt&&Ut(gt)),a!==n?r=Rt(o):(Pt=r,r=n)):(Pt=r,r=n),Nt--,r===n&&(0===Nt&&Ut(ft)),r}function Xt(){var r,e;for(Nt++,r=[],e=t.charAt(Pt),T.test(e)?Pt++:(e=n,0===Nt&&Ut(yt));e!==n;)r.push(e),e=t.charAt(Pt),T.test(e)?Pt++:(e=n,0===Nt&&Ut(yt));return Nt--,e=n,0===Nt&&Ut(xt),r}if(e=u(),r.peg$library)return{peg$result:e,peg$currPos:Pt,peg$FAILED:n,peg$maxFailExpected:Zt,peg$maxFailPos:Tt};if(e!==n&&Pt===t.length)return e;throw e!==n&&Pt<t.length&&Ut({type:"end"}),qt(Zt,Tt<t.length?t.charAt(Tt):null,Tt<t.length?Lt(Tt,Tt+1):Lt(Tt,Tt))}peg$subclass(peg$SyntaxError,Error),peg$SyntaxError.prototype.format=function(t){var r="Error: "+this.message;if(this.location){var e,n=null;for(e=0;e<t.length;e++)if(t[e].source===this.location.source){n=t[e].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,a=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(o):o,u=this.location.source+":"+a.line+":"+a.column;if(n){var c=this.location.end,i=peg$padEnd("",a.line.toString().length," "),s=n[o.line-1],l=(o.line===c.line?c.column:s.length+1)-o.column||1;r+="\n --\x3e "+u+"\n"+i+" |\n"+a.line+" | "+s+"\n"+i+" | "+peg$padEnd("",o.column-1," ")+peg$padEnd("",l,"^")}else r+="\n at "+u}return r},peg$SyntaxError.buildMessage=function(t,r){var e={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var r=t.parts.map((function(t){return Array.isArray(t)?a(t[0])+"-"+a(t[1]):a(t)}));return"["+(t.inverted?"^":"")+r.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function a(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function u(t){return e[t.type](t)}return"Expected "+function(t){var r,e,n=t.map(u);if(n.sort(),n.length>0){for(r=1,e=1;r<n.length;r++)n[r-1]!==n[r]&&(n[e]=n[r],e++);n.length=e}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(r)+" found."};const peg$allowedStartRules=["pgn"];export{peg$allowedStartRules as StartRules,peg$SyntaxError as SyntaxError,peg$parse as parse};
//# sourceMappingURL=/sm/bc03b7cfacde41e3f4df7e3a0e940b20699b315296c630b75036724b6284f796.map
